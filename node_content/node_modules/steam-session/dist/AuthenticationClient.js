"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const debug_1 = __importDefault(require("debug"));
const node_bignumber_1 = require("node-bignumber");
const load_1 = __importDefault(require("./protobuf-generated/load"));
const EResult_1 = __importDefault(require("./enums-steam/EResult"));
const helpers_1 = require("./helpers");
const events_1 = __importDefault(require("events"));
const EAuthTokenPlatformType_1 = __importDefault(require("./enums-steam/EAuthTokenPlatformType"));
const debug = (0, debug_1.default)('steam-session:AuthenticationClient');
class AuthenticationClient extends events_1.default {
    constructor(platformType, transport, webClient) {
        super();
        this._transport = transport;
        this._platformType = platformType;
        this._webClient = webClient;
    }
    async getRsaKey(accountName) {
        return await this.sendRequest({
            apiInterface: 'Authentication',
            apiMethod: 'GetPasswordRSAPublicKey',
            apiVersion: 1,
            data: { account_name: accountName }
        });
    }
    async encryptPassword(accountName, password) {
        let rsaInfo = await this.getRsaKey(accountName);
        let key = new node_bignumber_1.Key();
        key.setPublic(rsaInfo.publickey_mod, rsaInfo.publickey_exp);
        return {
            encryptedPassword: (0, node_bignumber_1.hex2b64)(key.encrypt(password)),
            keyTimestamp: rsaInfo.timestamp
        };
    }
    async startSessionWithCredentials(details) {
        let { websiteId, deviceDetails } = (0, helpers_1.getDataForPlatformType)(details.platformType);
        let data = {
            account_name: details.accountName,
            encrypted_password: details.encryptedPassword,
            encryption_timestamp: details.keyTimestamp,
            persistence: details.persistence,
            website_id: websiteId,
            device_details: deviceDetails
        };
        if (details.platformType == EAuthTokenPlatformType_1.default.SteamClient) {
            // At least for SteamClient logins, we don't supply device_details.
            // TODO: check if this is true for other platform types
            data.device_friendly_name = deviceDetails.device_friendly_name;
            data.platform_type = deviceDetails.platform_type;
            delete data.device_details;
        }
        if (details.steamGuardMachineToken) {
            if (Buffer.isBuffer(details.steamGuardMachineToken)) {
                data.guard_data = details.steamGuardMachineToken;
            }
            else if (typeof details.steamGuardMachineToken == 'string' && (0, helpers_1.isJwtValidForAudience)(details.steamGuardMachineToken, 'machine')) {
                data.guard_data = Buffer.from(details.steamGuardMachineToken, 'utf8');
            }
        }
        let result = await this.sendRequest({
            apiInterface: 'Authentication',
            apiMethod: 'BeginAuthSessionViaCredentials',
            apiVersion: 1,
            data
        });
        return {
            clientId: result.client_id,
            requestId: result.request_id,
            pollInterval: result.interval,
            allowedConfirmations: result.allowed_confirmations.map(c => ({ type: c.confirmation_type, message: c.associated_message })),
            steamId: result.steamid,
            weakToken: result.weak_token
        };
    }
    async startSessionWithQR(details) {
        let { deviceDetails } = (0, helpers_1.getDataForPlatformType)(details.platformType);
        let data = {
            device_details: deviceDetails
        };
        let result = await this.sendRequest({
            apiInterface: 'Authentication',
            apiMethod: 'BeginAuthSessionViaQR',
            apiVersion: 1,
            data
        });
        return {
            clientId: result.client_id,
            requestId: result.request_id,
            pollInterval: result.interval,
            allowedConfirmations: result.allowed_confirmations.map(c => ({ type: c.confirmation_type, message: c.associated_message })),
            challengeUrl: result.challenge_url,
            version: result.version
        };
    }
    async submitSteamGuardCode(details) {
        let data = {
            client_id: details.clientId,
            steamid: details.steamId,
            code: details.authCode,
            code_type: details.authCodeType
        };
        await this.sendRequest({
            apiInterface: 'Authentication',
            apiMethod: 'UpdateAuthSessionWithSteamGuardCode',
            apiVersion: 1,
            data
        });
    }
    async checkMachineAuthOrSendCodeEmail(details) {
        let headers = Object.assign({ 'content-type': 'multipart/form-data' }, helpers_1.API_HEADERS);
        if (details.machineAuthToken) {
            headers.cookie = `steamMachineAuth${details.steamId}=${details.machineAuthToken}`;
        }
        let body = { clientid: details.clientId, steamid: details.steamId };
        debug('POST https://login.steampowered.com/jwt/checkdevice %o', body);
        let result = await this._webClient.postEncoded('https://login.steampowered.com/jwt/checkdevice', body, 'multipart', {
            headers: helpers_1.API_HEADERS
        });
        return result.body;
    }
    async pollLoginStatus(details) {
        let data = {
            client_id: details.clientId,
            request_id: details.requestId
        };
        let result = await this.sendRequest({
            apiInterface: 'Authentication',
            apiMethod: 'PollAuthSessionStatus',
            apiVersion: 1,
            data
        });
        return {
            newClientId: result.new_client_id,
            newChallengeUrl: result.new_challenge_url,
            refreshToken: result.refresh_token,
            accessToken: result.access_token,
            hadRemoteInteraction: result.had_remote_interaction,
            accountName: result.account_name,
            newSteamGuardMachineAuth: result.new_guard_data
        };
    }
    async getAuthSessionInfo(accessToken, details) {
        let data = {
            client_id: details.clientId
        };
        let result = await this.sendRequest({
            apiInterface: 'Authentication',
            apiMethod: 'GetAuthSessionInfo',
            apiVersion: 1,
            data,
            accessToken
        });
        return {
            ip: result.ip,
            geoloc: result.geoloc,
            city: result.city,
            state: result.state,
            platformType: result.platform_type,
            deviceFriendlyName: result.device_friendly_name,
            version: result.version,
            loginHistory: result.login_history,
            locationMismatch: result.requestor_location_mismatch,
            highUsageLogin: result.high_usage_login,
            requestedPersistence: result.requested_persistence
        };
    }
    async submitMobileConfirmation(accessToken, details) {
        let data = {
            version: details.version,
            client_id: details.clientId,
            steamid: details.steamId,
            signature: details.signature,
            confirm: details.confirm,
            persistence: details.persistence
        };
        await this.sendRequest({
            apiInterface: 'Authentication',
            apiMethod: 'UpdateAuthSessionWithMobileConfirmation',
            apiVersion: 1,
            data,
            accessToken
        });
    }
    async sendRequest(request) {
        // Right now we really only support IAuthenticationService
        let protoSignature = `C${request.apiInterface}_${request.apiMethod}`;
        let requestProtoSignature = `${protoSignature}_Request`;
        let responseProtoSignature = `${protoSignature}_Response`;
        if (protoSignature == 'CAuthentication_BeginAuthSessionViaCredentials') {
            // we need to use our custom definition to support sentry file hashes
            requestProtoSignature += '_BinaryGuardData';
        }
        let requestProto = load_1.default[requestProtoSignature];
        let responseProto = load_1.default[responseProtoSignature];
        if (!requestProto || !responseProto) {
            throw new Error(`Unknown API method ${request.apiInterface}/${request.apiMethod}`);
        }
        let { headers } = (0, helpers_1.getDataForPlatformType)(this._platformType);
        this.emit('debug', request.apiMethod, request.data, headers);
        let result = await this._transport.sendRequest({
            apiInterface: request.apiInterface,
            apiMethod: request.apiMethod,
            apiVersion: request.apiVersion,
            requestData: requestProto.encode(request.data).finish(),
            accessToken: request.accessToken,
            headers
        });
        if (result.result != EResult_1.default.OK) {
            throw (0, helpers_1.eresultError)(result.result, result.errorMessage);
        }
        // We need to decode the response data, if there was any
        let responseData = result.responseData && result.responseData.length > 0 ? result.responseData : Buffer.alloc(0);
        let decodedData = responseProto.decode(responseData);
        return responseProto.toObject(decodedData, { longs: String });
    }
    close() {
        this._transport.close();
    }
}
exports.default = AuthenticationClient;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0aGVudGljYXRpb25DbGllbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvQXV0aGVudGljYXRpb25DbGllbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxrREFBZ0M7QUFDaEMsbURBQXNEO0FBRXRELHFFQUErQztBQUUvQyxvRUFBNEM7QUFDNUMsdUNBQW1HO0FBNEJuRyxvREFBa0M7QUFDbEMsa0dBQTBFO0FBRzFFLE1BQU0sS0FBSyxHQUFHLElBQUEsZUFBVyxFQUFDLG9DQUFvQyxDQUFDLENBQUM7QUFVaEUsTUFBcUIsb0JBQXFCLFNBQVEsZ0JBQVk7SUFLN0QsWUFBWSxZQUFvQyxFQUFFLFNBQXFCLEVBQUUsU0FBb0I7UUFDNUYsS0FBSyxFQUFFLENBQUM7UUFDUixJQUFJLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQztRQUM1QixJQUFJLENBQUMsYUFBYSxHQUFHLFlBQVksQ0FBQztRQUNsQyxJQUFJLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQztJQUM3QixDQUFDO0lBRUQsS0FBSyxDQUFDLFNBQVMsQ0FBQyxXQUFtQjtRQUNsQyxPQUFPLE1BQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQztZQUM3QixZQUFZLEVBQUUsZ0JBQWdCO1lBQzlCLFNBQVMsRUFBRSx5QkFBeUI7WUFDcEMsVUFBVSxFQUFFLENBQUM7WUFDYixJQUFJLEVBQUUsRUFBQyxZQUFZLEVBQUUsV0FBVyxFQUFDO1NBQ2pDLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFRCxLQUFLLENBQUMsZUFBZSxDQUFDLFdBQW1CLEVBQUUsUUFBZ0I7UUFDMUQsSUFBSSxPQUFPLEdBQUcsTUFBTSxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBRWhELElBQUksR0FBRyxHQUFHLElBQUksb0JBQU0sRUFBRSxDQUFDO1FBQ3ZCLEdBQUcsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxPQUFPLENBQUMsYUFBYSxDQUFDLENB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